<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>
    <link rel="stylesheet" href="./css/iconfont.css"/>
    <style>
        *{
            margin: 0;
            padding: 0;
        }
        .item-list{
            width: 570px;
            height: 450px;
            border: 1px solid #000;
            margin: 0 auto;
            overflow: hidden;
        }
        .item-tab{
            float: left;
            width: 450px;
            height: 450px;
        }
        .item-child{
            width: 430px;
            height: 430px;
            margin: 10px;
            overflow: hidden;
        }
        .item-menu{
            position: relative;
            float: left;
            width: 120px;
            height: 450px;
        }
        .item-menu-child{
            width: 100px;
            height: 430px;
            margin: 10px;
            overflow: hidden;
            position: relative;
        }
        .transY {
            transition: transform .3s ease-in-out;
        }
        .item-child-ul>li{
            list-style: none;
            height: 430px;
        }
        .item-child-ul>li img,.item-tab-info>li img{
            width: 100%;
            height: 100%;
            vertical-align: middle;
        }
        .item-tab-info {
            transition: all .2s ease-in;
        }
        .item-tab-info>li{
            position: relative;
            list-style: none;
            width: 100px;
            height: 100px;
            margin-bottom: 10px;
            border-radius: 10px;
            overflow: hidden;
        }
        .item-tab-info > li:last-child {
            margin-bottom: 0;
        }
        .top-white:after{
            content: "";
            position: absolute;
            left: 0;
            top: 0;
            z-index: 1;
            width: 100%;
            height: 100%;
            background-color: rgba(255,255,255,0.5);
        }
        .line{
            position: absolute;
            z-index: 5;
            left: 10px;
            top: 10px;
            width: 100px;
            height: 100px;
            border: 3px solid darkred;
            border-radius: 10px;
            box-sizing: border-box;
            transition: top .3s ease-in;
        }
        .line:after{
            content: "";
            position: absolute;
            left: -30px;
            top: 35px;
            border: 15px solid transparent;
            border-color: transparent #d10000 transparent transparent;
        }
        .top-btn,.bottom-btn{
            position: absolute;
            z-index: 10;
            width: 20px;
            height: 20px;
            font-size: 12px;
            text-align: center;
            line-height: 20px;
            left: 50px;
            background-color: #666666;
            color: #fff;
            transition: all .3s ease-in;

        }
        .top-btn{
            top: -20px;
            border-radius: 0 0 50% 50%;
        }
        .bottom-btn{
            bottom: -20px;
            border-radius: 50% 50% 0 0;;
        }
        .showTop {
            top: 0;
        }

        .showBottom {
            bottom: 0;
        }
    </style>
</head>
<body>
<div class="item-list">
    <div class="item-tab">
        <div class="item-child">
            <ul class="item-child-ul transY">
                <li><img src="./image/1.jpg" alt=""/></li>
                <li><img src="./image/2.jpg" alt=""/></li>
                <li><img src="./image/3.jpg" alt=""/></li>
                <li><img src="./image/4.jpg" alt=""/></li>
                <li><img src="./image/5.jpg" alt=""/></li>
                <li><img src="./image/6.jpg" alt=""/></li>
            </ul>
        </div>
    </div>
    <div class="item-menu">
        <div class="line" style="top: 10px;"></div>
        <span class="top-btn iconfont iconfont-xiangxia"></span>
        <span class="bottom-btn iconfont iconfont-xiangshang1"></span>
        <div class="item-menu-child">
            <ul class="item-tab-info">
                <li class="right-btn"><img src="./image/1.jpg" alt=""/></li>
                <li class="right-btn top-white"><img src="./image/2.jpg" alt=""/></li>
                <li class="right-btn top-white"><img src="./image/3.jpg" alt=""/></li>
                <li class="right-btn top-white"><img src="./image/4.jpg" alt=""/></li>
                <li class="right-btn top-white"><img src="./image/5.jpg" alt=""/></li>
                <li class="right-btn top-white"><img src="./image/6.jpg" alt=""/></li>
            </ul>
        </div>
    </div>
</div>
<script>
    //找到right-btn 元素添加事件
    var righttBtnList;
    var Line;
    var transy = 0;
    var liHeight = 430;
    var ulItem;
    var count = 0;
    var timer;
    var speed = 2000;
    var Item;
    var ItemMenu;
    var offsetTop = 0;
    var itemtabinfo, topBtn, bottomBtn;
    window.onload = function () {
        righttBtnList = document.getElementsByClassName("right-btn");
        Line = document.getElementsByClassName("line")[0];
        ulItem = document.getElementsByClassName("item-child-ul")[0];
        Item = document.getElementsByClassName("item-list")[0];
        ItemMenu = document.getElementsByClassName("item-menu")[0];
        itemtabinfo = document.getElementsByClassName("item-tab-info")[0];
        topBtn = document.getElementsByClassName("top-btn")[0];
        bottomBtn = document.getElementsByClassName("bottom-btn")[0];
        //默认复制第一张添加到ulItem之中
        ulItem.appendChild(ulItem.children[0].cloneNode(true));
        //设置itemtabinfo 默认移动值
        itemtabinfo.style.transform = "translateY(" + offsetTop + "px)";
        //直接默认启动计时器
        Animate();
        //遍历所有的li添加事件
        for (var i = 0; i < righttBtnList.length; i++) {
            righttBtnList[i].index = i;
            righttBtnList[i].onclick = function () {
                //点击当前移除top-white
                if (checkClass(this, 'top-white')) {
                    this.classList.remove("top-white");
                    //其余的添加
                    addWhite(this.index);
                }
                //获取偏移值
                Line.style.top = ((this.index * 110 + 10) + offsetTop) + "px";
                //输出当前点击的索引
                ulItem.style.transform = "translateY(" + (-this.index * liHeight) + "px)";
                //用户点击的索引  对应count值
                count = this.index;
            }
        }

        Item.onmouseenter=function(){
            clearTimeout(timer);
        }
        Item.onmouseleave=function(){
            Animate();
        }
        topBtn.onclick = function () {
            offsetTop += 110;
            //获取原来的top
            var oldTop = parseFloat(Line.style.top);
            Line.style.top = (oldTop + 110) + "px";
            itemtabinfo.style.transform = "translateY(" + offsetTop + "px)";
            checkBtnShow();
        }
        bottomBtn.onclick = function () {
            offsetTop -= 110;
            //获取原来的top
            var oldTop = parseFloat(Line.style.top);
            //只能取到行内样式
            Line.style.top = (oldTop - 110) + "px";
            itemtabinfo.style.transform = "translateY(" + offsetTop + "px)";
            checkBtnShow();
        }

        ItemMenu.onmouseenter = function () {
            checkBtnShow();
        }
        function checkBtnShow() {
            if (offsetTop == 0) {
                //下面按钮出现
                bottomBtn.classList.add("showBottom");
                topBtn.classList.remove("showTop");

            }
            else if (offsetTop == -220) {
                //上面按钮出现
                topBtn.classList.add("showTop");
                bottomBtn.classList.remove("showBottom");
            } else {
                //两个按钮同时出现
                bottomBtn.classList.add("showBottom");
                topBtn.classList.add("showTop");
            }
        }

        ItemMenu.onmouseleave = function () {
            bottomBtn.classList.remove("showBottom");
            topBtn.classList.remove("showTop");
        }
        //检测是否具有top-white
        function checkClass(obj,className){
            return obj.classList.contains(className);
        }
        //其余的li添加
        function addWhite(index){
            for(var i=0;i<righttBtnList.length;i++){
                if(i!=index){
                    righttBtnList[i].classList.add("top-white");
                }
            }
        }
        //启动计时器动画
        function Animate(){
            //写执行代码
            timer=setInterval(function(){
                if (timer)
                    clearInterval(timer);
                if(!ulItem.classList.contains("transY")){
                    ulItem.classList.add("transY");
                }
                count++;
                ulItem.style.transform="translateY("+(-count*liHeight)+"px)";
                //找出当前每一张图动画完成时间
                setTimeout(function(){
                    if(count>=ulItem.children.length-1){
                        count=0;
                        //移除过渡类
                        ulItem.classList.remove("transY");
                        ulItem.style.transform="translateY(0px)";
                    }
                    //让右边的元素动画对应
                    //rigthBtnlist[count].click();
                },500)
            },speed)
        }
    }
</script>
</body>
</html>